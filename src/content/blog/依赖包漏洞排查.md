---
author: cobo
pubDatetime: 2023-01-30T15:57:52.737Z
title: 依赖包漏洞排查
featured: false
draft: false
tags:
 - robot
description: this is auto generate
---
#java
# 漏洞修复方案
项目引用了各种开源工具包，漏扫后出现很多漏洞修复。以下为行之有效的漏洞扫描修复方案。漏扫工具会给出一份漏扫结果如下
[漏洞扫描结果](./resources/%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F.md)。

首先查看漏扫结果，粗略的扫描后发现有很多spring,jackson相关的bug。漏洞解决顺序推荐如下

1. 基础组件框架（spring,swagger）
2. pom.xml里明确定义的依赖版本
3. 开源组件的依赖，如jackson

## 1. 基础组件框架
基础组件框架较为重要，业务依赖也相对较多。同时因为依赖较多，所以当出现大量漏洞的时候，升级它的版本一些开源组件内部依赖的漏洞也可以跟随版本一起修复。

### 解决方案
根据漏扫结果，在maven仓库查询，漏扫推荐版本是否有bug。![img39](@assets/images/img39.png)
如果推荐的版本也有漏洞，则按如下方案进行：
![jar包选择方案](./resources/%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F%E6%B5%81%E7%A8%8B.drawio.svg)

基础组件框架升级完成后，启动项目，由于版本升级可能存在api变更，此时修改至项目正常启动即可

## 2. pom.xml依赖版本
pom.xml 指定的依赖版本，按推荐版本升级，版本选择顺序：
1. 版本号按从右往左依次挑选
2. 升级小版本号不满足要求，则选择第二位版本号的升级，尽量不跨越大版本
3. 升级后有问题，看看有没有其他包可以替换，涉及双方加解密方案的，建议先搁置最后处理
4. jar包选择方案可以参照步骤1

升级，修改项目正常启动

## 3. 开源组件依赖
升级开源组件依赖包，在第一步，第二步，漏扫出来的bug可能已经修复了，剩下的按如下步骤
1. 找到有漏洞的包，属于pom.xml 那个包引入的
2. exclusion对应包后按 步骤二选择合适的fix lib

### 找到漏洞包引入路径

使用mvn命令，扫描依赖。找到漏扫版本的lib
```sh
mvn  dependency:tree -Dincludes=org.mybatis:mybatis
```
查找到对应漏洞包位置，按之前描述的修复方案执行即可

		<dependency>
			<groupId>jakarta.servlet</groupId>
			<artifactId>jakarta.servlet-api</artifactId>
			<version>4.0.4</version>
			<scope>provided</scope>
		</dependency>


		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-jetty</artifactId>
		</dependency>

https://blog.csdn.net/aachangs/article/details/115629621

