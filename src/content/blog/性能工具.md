---
author: cobo
pubDatetime: 2023-01-30T15:57:52.737Z
title: 性能工具
featured: false
draft: false
tags:
 - robot
description: this is auto generate
---
# 性能工具
-   性能工具谱图
-   CPU 性能工具
-   内存性能工具
-   磁盘 I/O 性能工具
-   网络性能工具

1. CPU性能工具
首先，从 CPU 的角度来说，主要的性能指标就是 CPU 的使用率、上下文切换以及 CPU Cache 的命中率等。下面这张图就列出了常见的 CPU 性能指标。
![CPU性能指标.png](./CPU性能指标.png)
|性能指标|性能工具|说明|
|-------------|-----------|-------|
|平均负载|uptime top /proc/loadavg|uptime最简单；top提供了更全的指标/proc/loadavg常用于监控系统|
|系统cpu使用率|vmstart mpst at top sar /proc/stat|top vmstat,mpstat只可以动态查看，sar可以记录历史数据/proc/stat是其他性能工具数据来源，也常用于监控|
|进程CPU使用率|top pspidstat htop atop|top和ps可以按CPU使用率给进程排序，而pidstat只显示实际用了CPU的进程;htop和atop以不同颜色显示更直观|
|系统上下文切换|vmstat|除了上下文切换次数，还提供运行状态和不可中断状态进程的数量|
|进程上下文切换|pidstat|注意加上-w 选项|
|软中断|top mpstat /proc/softirgs|top提供软中断CPU使用率，而/proc/softirgs和mpstat提供了各种软中断在每个CPU上的运行次数|
|硬中断|vmstat /proc/interrupts|vmstat提供总的中断次数，而/proc/interrupts提供各种中断在每个CPU上运行的累积次数|
|网络|dstat sar tcpdump|dstat和sar提供总的网络接收和发送情况，而tcpdump则是动态抓取正在进行的网络通讯|
|IO|dstat sar|dstat和sar都提供了I/O的整体情况|
|CPU缓存|perf|使用 perf stat 子命令|
|事件剖析|lscpu /proc/cpuinfo|lscpu更直观|
|动态追踪|perf 或沿途execsnoop|perf和火焰图用来分析热点函数以及调用栈，execsnoop用来监测短时进程|


2. 内存性能工具
接着我们来看内存方面。从内存的角度来说，主要的性能指标，就是系统内存的分配和使用、进程内存的分配和使用以及 SWAP 的用量。下面这张图列出了常见的内存性能指标。
![内存性能指标](./内存性能指标.png)
![优化](./内存性能优化.png)
3. 磁盘性能工具
接下来，从文件系统和磁盘 I/O 的角度来说，主要性能指标，就是文件系统的使用、缓存和缓冲区的使用，以及磁盘 I/O 的使用率、吞吐量和延迟等。下面这张图列出了常见的 I/O 性能指标。
![IO性能指标](./IO性能指标.png)
![磁盘](./磁盘性能工具.png)
4. 网络性能工具
最后，从网络的角度来说，主要性能指标就是吞吐量、响应时间、连接数、丢包数等。根据 TCP/IP 网络协议栈的原理，我们可以把这些性能指标，进一步细化为每层协议的具体指标。这里我同样用一张图，分别从链路层、网络层、传输层和应用层，列出了各层的主要指标
![网络性能指标](./网络性能指标.png)
![网络性能](./网络性能.png)