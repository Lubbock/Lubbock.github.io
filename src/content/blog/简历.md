---
author: cobo
pubDatetime: 2023-01-30T15:57:52.737Z
title: 简历
featured: false
draft: false
tags:
 - robot
description: this is auto generate
---
import org.apache.commons.codec.binary.Base64;
import org.bouncycastle.crypto.digests.SM3Digest;
import org.bouncycastle.crypto.macs.HMac;
import org.bouncycastle.crypto.params.KeyParameter;

import java.nio.charset.StandardCharsets;

String sk = "${sk}";
byte[] key = Base64.decodeBase64(sk);
//String requestBody = "{\n\"b64OriginData": "MTIz",
//  "certAlias": "RABizOper"
//}"
String requestBody = sampler.getArguments().getArgument(0).getValue();
requestBody=requestBody.replaceAll("\r","");
requestBody=requestBody.replaceAll("\n","");
byte[] srcData = requestBody.getBytes(StandardCharsets.UTF_8);
KeyParameter keyParameter = new KeyParameter(key);
SM3Digest digest = new SM3Digest();
HMac mac = new HMac(digest);
mac.init(keyParameter);
mac.update(srcData, 0, srcData.length);
byte[] result = new byte[mac.getMacSize()];
mac.doFinal(result, 0);
String hmac = org.apache.commons.codec.binary.Base64.encodeBase64String(result);
vars.put("hmac",hmac);
vars.put("asdasd",requestBody)

